window.isiOS = !1;
if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
  window.isiOS = !0;
}
window.isiOSVersion = "";
if (window.isiOS) {
  var version = navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);
  if (version !== null) {
    window.isiOSVersion = [
      parseInt(version[1], 10),
      parseInt(version[2], 10),
      parseInt(version[3] || 0, 10),
    ];
  }
}
function t_throttle(fn, threshhold, scope) {
  var last;
  var deferTimer;
  threshhold || (threshhold = 250);
  return function () {
    var context = scope || this;
    var now = +new Date();
    var args = arguments;
    if (last && now < last + threshhold) {
      clearTimeout(deferTimer);
      deferTimer = setTimeout(function () {
        last = now;
        fn.apply(context, args);
      }, threshhold);
    } else {
      last = now;
      fn.apply(context, args);
    }
  };
}
function t585_init(recId) {
  var rec = document.getElementById("rec" + recId);
  if (!rec) return;
  var accordion = rec.querySelectorAll(".t585__accordion")[0];
  var headers = rec.querySelectorAll(".t585__header");
  var isLazy = document
    .getElementById("allrecords")
    .getAttribute("data-tilda-lazy");
  var accordionScroll;
  if (accordion) {
    accordionScroll = accordion.getAttribute("data-scroll-to-expanded");
    accordion = accordion.getAttribute("data-accordion");
  } else {
    accordion = "false";
    accordionScroll = "false";
  }
  for (var i = 0; i < headers.length; i++) {
    headers[i].addEventListener("click", function () {
      var element = this;
      var container = element.nextElementSibling;
      var activeHeight = 0;
      var isAccordionDown = !1;
      if (element.classList.contains("t585__opened")) {
        element.classList.remove("t585__opened");
        t585_accordionHide(container);
      } else {
        if (accordionScroll === "true" && accordion === "true") {
          activeHeight = t585__getOldAction(rec);
          isAccordionDown = t585__getAccordionPosition(headers, element);
        }
        if (accordion === "true") t585_accordionAllHide(headers);
        element.classList.add("t585__opened");
        container.style.display = "block";
        var height = container.scrollHeight;
        container.style.maxHeight = "0px";
        setTimeout(function () {
          container.style.maxHeight = height + "px";
          if (accordionScroll === "true") {
            t585__calcHeight(element, container, activeHeight, isAccordionDown);
          }
        }, 0);
      }
      if (window.lazy === "y" || isLazy === "yes") {
        t_onFuncLoad("t_lazyload_update", function () {
          t_lazyload_update();
        });
      }
    });
  }
}
function t585_accordionAllHide(headers) {
  for (var i = 0; i < headers.length; i++) {
    var elementHide = headers[i];
    elementHide.classList.remove("t585__opened");
    t585_accordionHide(elementHide.nextElementSibling);
  }
}
function t585_accordionHide(container) {
  if (!container.style.maxHeight)
    container.style.maxHeight = container.scrollHeight + "px";
  setTimeout(function () {
    container.style.maxHeight = "0px";
  }, 0);
}
function t585__getOldAction(rec) {
  var activeHeader = rec.querySelector(".t585__opened");
  var activeHeight = 0;
  if (activeHeader) var activeContainer = activeHeader.nextElementSibling;
  if (activeContainer) activeHeight = activeContainer.offsetHeight;
  return activeHeight;
}
function t585__getAccordionPosition(headers, element) {
  var oldIndex;
  var newIndex;
  for (var i = 0; i < headers.length; i++) {
    var header = headers[i];
    if (header.classList.contains("t585__opened")) oldIndex = i;
    if (header === element) newIndex = i;
  }
  return oldIndex < newIndex ? !0 : !1;
}
function t585__calcHeight(element, container, activeHeight, isAccordionDown) {
  var windowHeight = window.innerHeight;
  var windowScroll = window.scrollY;
  var containerHeight = container.scrollHeight;
  var accordionHeight = containerHeight + element.offsetHeight;
  var elementTopOffset = element.getBoundingClientRect().top + windowScroll;
  var target = isAccordionDown
    ? elementTopOffset - activeHeight
    : elementTopOffset;
  var accordionBottomLine = target + accordionHeight;
  var windowBottomLine = windowScroll + windowHeight;
  if (
    target < windowScroll ||
    accordionHeight > windowHeight ||
    accordionBottomLine > windowBottomLine
  ) {
    t585__scroll(target);
  }
}
function t585__scroll(target) {
  var duration = 400;
  var start =
    (window.pageYOffset || document.documentElement.scrollTop) -
    (document.documentElement.clientTop || 0);
  var change = target - start;
  var currentTime = 0;
  var increment = 16;
  document.body.setAttribute("data-scrollable", "true");
  function t585__easeInOutCubic(currentTime) {
    if ((currentTime /= duration / 2) < 1) {
      return (change / 2) * currentTime * currentTime * currentTime + start;
    } else {
      return (
        (change / 2) * ((currentTime -= 2) * currentTime * currentTime + 2) +
        start
      );
    }
  }
  function t585__animateScroll() {
    currentTime += increment;
    window.scrollTo(0, t585__easeInOutCubic(currentTime));
    if (currentTime < duration) {
      setTimeout(t585__animateScroll, increment);
    } else {
      document.body.removeAttribute("data-scrollable");
    }
  }
  t585__animateScroll();
}
function t702_initPopup(recId) {
  var rec = document.getElementById("rec" + recId);
  if (!rec) return;
  var container = rec.querySelector(".t702");
  if (!container) return;
  rec.setAttribute("data-animationappear", "off");
  rec.setAttribute("data-popup-subscribe-inited", "y");
  rec.style.opacity = 1;
  var documentBody = document.body;
  var popup = rec.querySelector(".t-popup");
  var popupTooltipHook = popup.getAttribute("data-tooltip-hook");
  var analitics = popup.getAttribute("data-track-popup");
  var popupCloseBtn = popup.querySelector(".t-popup__close");
  var hrefs = rec.querySelectorAll('a[href*="#"]');
  var submitHref = rec.querySelector('.t-submit[href*="#"]');
  if (popupTooltipHook) {
    t_onFuncLoad("t_popup__addAttributesForAccessibility", function () {
      t_popup__addAttributesForAccessibility(popupTooltipHook);
    });
    document.addEventListener("click", function () {
      var target = event.target;
      var href = target.closest('a[href*="#"]')
        ? target.closest('a[href*="#"]')
        : !1;
      if (!href) return;
      var arrHref = href.href.split("#");
      if (decodeURI("#" + arrHref[1]) !== popupTooltipHook) return;
      event.preventDefault();
      t702_showPopup(recId);
      t_onFuncLoad("t_popup__resizePopup", function () {
        t_popup__resizePopup(recId);
      });
      t702__lazyLoad();
      if (analitics) {
        Tilda.sendEventToStatistics(analitics, popupTooltipHook);
      }
    });
    t_onFuncLoad("t_popup__addClassOnTriggerButton", function () {
      t_popup__addClassOnTriggerButton(document, popupTooltipHook);
    });
  }
  popup.addEventListener(
    "scroll",
    t_throttle(function () {
      t702__lazyLoad();
    })
  );
  popup.addEventListener("click", function (event) {
    var windowWithoutScrollBar = window.innerWidth - 17;
    if (event.clientX > windowWithoutScrollBar) return;
    if (event.target === this) t702_closePopup(recId);
  });
  popupCloseBtn.addEventListener("click", function () {
    t702_closePopup(recId);
  });
  if (submitHref) {
    submitHref.addEventListener("click", function () {
      if (documentBody.classList.contains("t-body_scroll-locked")) {
        documentBody.classList.remove("t-body_scroll-locked");
      }
    });
  }
  for (var i = 0; i < hrefs.length; i++) {
    hrefs[i].addEventListener("click", function () {
      var url = this.getAttribute("href");
      if (!url || url.substring(0, 7) != "#price:") {
        t702_closePopup(recId);
        if (!url || url.substring(0, 7) == "#popup:") {
          setTimeout(function () {
            documentBody.classList.add("t-body_popupshowed");
          }, 300);
        }
      }
    });
  }
  function t702_escClosePopup(event) {
    if (event.key === "Escape") t702_closePopup(recId);
  }
  popup.addEventListener("tildamodal:show" + popupTooltipHook, function () {
    document.addEventListener("keydown", t702_escClosePopup);
  });
  popup.addEventListener("tildamodal:close" + popupTooltipHook, function () {
    document.removeEventListener("keydown", t702_escClosePopup);
  });
}
function t702_lockScroll() {
  var documentBody = document.body;
  if (!documentBody.classList.contains("t-body_scroll-locked")) {
    var bodyScrollTop =
      typeof window.pageYOffset !== "undefined"
        ? window.pageYOffset
        : (document.documentElement || documentBody.parentNode || documentBody)
            .scrollTop;
    documentBody.classList.add("t-body_scroll-locked");
    documentBody.style.top = "-" + bodyScrollTop + "px";
    documentBody.setAttribute("data-popup-scrolltop", bodyScrollTop);
  }
}
function t702_unlockScroll() {
  var documentBody = document.body;
  if (documentBody.classList.contains("t-body_scroll-locked")) {
    var bodyScrollTop = documentBody.getAttribute("data-popup-scrolltop");
    documentBody.classList.remove("t-body_scroll-locked");
    documentBody.style.top = null;
    documentBody.removeAttribute("data-popup-scrolltop");
    document.documentElement.scrollTop = parseInt(bodyScrollTop);
  }
}
function t702_showPopup(recId) {
  var rec = document.getElementById("rec" + recId);
  if (!rec) return;
  var container = rec.querySelector(".t702");
  if (!container) return;
  var popup = rec.querySelector(".t-popup");
  var popupTooltipHook = popup.getAttribute("data-tooltip-hook");
  var range = rec.querySelector(".t-range");
  var documentBody = document.body;
  if (range) t702__triggerEvent(range, "popupOpened");
  t_onFuncLoad("t_popup__showPopup", function () {
    t_popup__showPopup(popup);
  });
  documentBody.classList.add("t-body_popupshowed");
  documentBody.classList.add("t702__body_popupshowed");
  if (
    /iPhone|iPad|iPod/i.test(navigator.userAgent) &&
    !window.MSStream &&
    window.isiOSVersion &&
    window.isiOSVersion[0] === 11
  ) {
    setTimeout(function () {
      t702_lockScroll();
    }, 500);
  }
  t702__lazyLoad();
  t702__triggerEvent(popup, "tildamodal:show" + popupTooltipHook);
}
function t702_closePopup(recId) {
  var rec = document.getElementById("rec" + recId);
  var popup = rec.querySelector(".t-popup");
  var popupTooltipHook = popup.getAttribute("data-tooltip-hook");
  var popupAll = document.querySelectorAll(
    ".t-popup_show:not(.t-feed__post-popup)"
  );
  if (popupAll.length == 1) {
    document.body.classList.remove("t-body_popupshowed");
  } else {
    var newPopup = [];
    for (var i = 0; i < popupAll.length; i++) {
      if (popupAll[i].getAttribute("data-tooltip-hook") === popupTooltipHook) {
        popupAll[i].classList.remove("t-popup_show");
        newPopup.push(popupAll[i]);
      }
    }
    if (newPopup.length === popupAll.length) {
      document.body.classList.remove("t-body_popupshowed");
    }
  }
  popup.classList.remove("t-popup_show");
  document.body.classList.remove("t702__body_popupshowed");
  if (
    /iPhone|iPad|iPod/i.test(navigator.userAgent) &&
    !window.MSStream &&
    window.isiOSVersion &&
    window.isiOSVersion[0] === 11
  ) {
    t702_unlockScroll();
  }
  t_onFuncLoad("t_popup__addFocusOnTriggerButton", function () {
    t_popup__addFocusOnTriggerButton();
  });
  setTimeout(function () {
    var popupHide = document.querySelectorAll(".t-popup:not(.t-popup_show)");
    for (var i = 0; i < popupHide.length; i++) {
      popupHide[i].style.display = "none";
    }
  }, 300);
  t702__triggerEvent(popup, "tildamodal:close" + popupTooltipHook);
}
function t702_sendPopupEventToStatistics(popupName) {
  var virtPage = "/tilda/popup/";
  var virtTitle = "Popup: ";
  if (popupName.substring(0, 7) == "#popup:") {
    popupName = popupName.substring(7);
  }
  virtPage += popupName;
  virtTitle += popupName;
  if (window.Tilda && typeof Tilda.sendEventToStatistics == "function") {
    Tilda.sendEventToStatistics(virtPage, virtTitle, "", 0);
  } else {
    if (ga) {
      if (window.mainTracker != "tilda") {
        ga("send", { hitType: "pageview", page: virtPage, title: virtTitle });
      }
    }
    if (window.mainMetrika && window[window.mainMetrika]) {
      window[window.mainMetrika].hit(virtPage, {
        title: virtTitle,
        referer: window.location.href,
      });
    }
  }
}
function t702_onSuccess(form) {
  t_onFuncLoad("t_forms__onSuccess", function () {
    t_forms__onSuccess(form);
  });
}
function t702__lazyLoad() {
  if (
    window.lazy === "y" ||
    document.getElementById("allrecords").getAttribute("data-tilda-lazy") ===
      "yes"
  ) {
    t_onFuncLoad("t_lazyload_update", function () {
      t_lazyload_update();
    });
  }
}
function t702__triggerEvent(el, eventName) {
  var event;
  if (typeof window.CustomEvent === "function") {
    event = new CustomEvent(eventName);
  } else if (document.createEvent) {
    event = document.createEvent("HTMLEvents");
    event.initEvent(eventName, !0, !1);
  } else if (document.createEventObject) {
    event = document.createEventObject();
    event.eventType = eventName;
  }
  event.eventName = eventName;
  if (el.dispatchEvent) {
    el.dispatchEvent(event);
  } else if (el.fireEvent) {
    el.fireEvent("on" + event.eventType, event);
  } else if (el[eventName]) {
    el[eventName]();
  } else if (el["on" + eventName]) {
    el["on" + eventName]();
  }
}
function t706_onSuccessCallback() {
  var products = document.querySelector(".t706__cartwin-products");
  var cartBottom = document.querySelector(".t706__cartwin-bottom");
  var cartForm = document.querySelector(".t706 .t-form__inputsbox");
  if (products) t706_slideUp(products, 10);
  if (cartBottom) t706_slideUp(cartBottom, 10);
  if (cartForm) t706_slideUp(cartForm, 700);
  try {
    tcart__unlockScroll();
  } catch (error) {}
}
function t706_slideUp(target, duration) {
  if (!target) return;
  if (!duration && duration !== 0) duration = 500;
  target.style.transitionProperty = "height, margin, padding";
  target.style.transitionDuration = duration + "ms";
  target.style.boxSizing = "border-box";
  target.style.height = target.offsetHeight + "px";
  target.style.overflow = "hidden";
  target.style.height = "0";
  target.style.paddingTop = "0";
  target.style.paddingBottom = "0";
  target.style.marginTop = "0";
  target.style.marginBottom = "0";
  setTimeout(function () {
    target.style.display = "none";
    target.style.height = "";
    target.style.paddingTop = "";
    target.style.paddingBottom = "";
    target.style.marginTop = "";
    target.style.marginBottom = "";
    target.style.overflow = "";
    target.style.transitionDuration = "";
    target.style.transitionProperty = "";
  }, duration);
}
function t887_init(recid) {
  var rec = document.querySelector("#rec" + recid);
  if (!rec) return;
  var notificationBlock = rec.querySelector(".t887");
  var closeButton = rec.querySelector(".t887__icon-close");
  var storageItem = notificationBlock.getAttribute("data-storage-item");
  var lastOpen = null;
  if (typeof localStorage === "object") {
    try {
      lastOpen = localStorage.getItem(storageItem);
    } catch (error) {
      console.log(
        "Your web browser does not support localStorage. Error status: ",
        error
      );
    }
  }
  if (!lastOpen) {
    notificationBlock.classList.remove("t887_closed");
  }
  closeButton.addEventListener("click", function (event) {
    notificationBlock.classList.add("t887_closed");
    if (typeof localStorage === "object") {
      try {
        localStorage.setItem(storageItem, Math.floor(Date.now() / 1000));
      } catch (error) {
        console.log(
          "Your web browser does not support localStorage. Error status: ",
          error
        );
      }
    }
    event.preventDefault();
  });
}
